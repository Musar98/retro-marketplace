//TODO extract all db interactions